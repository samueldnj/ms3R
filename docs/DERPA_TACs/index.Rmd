---  
title: "Setting TACs using hierarchical stock assessment models improves management performance in multi-species, spatially-replicated, data-limited fisheries."
author:
  - name: Samuel D. N. Johnson
    email: samuelj@sfu.ca
    affiliation: a
    footnote: 1
  - name: Sean P. Cox
    email: spcox@sfu.ca
    affiliation: a
address:
  - code: a
    address: School of Resource and Environmental Management, Simon Fraser University, 8888 University Drive, BC, V5K 1S6, Canada
footnote:
  - code: 1
    text: Corresponding author
abstract: |
    Management performance of five alternative 
    stock assessment methods was evaluated by using them to set harvest 
    levels targeting multi-species maximum yield in a multi-species flatfish 
    fishery, including single-species and hierarchical multi-species 
    models, and methods that pooled data across species and spatial 
    strata, with catch outcomes of each method under three data scenarios 
    compared to catch under an omniscient manager simulation. 
    Operating models included technical interactions between species
    intended to produce choke effects often observed in output 
    controlled multi-species fisheries. Hierarchical multi-species models 
    outperformed all other methods under data-poor and data-moderate 
    scenarios, approaching optimal catch/biomass trajectories and avoiding
    states of conservation concern with high probability, and outperforme 
    single-species models under the data-rich scenario. 
    Choke effects were found to have both positive and negative outcomes, 
    sometimes leading to underfishing of non-choke species, but at other 
    times preventing overfishing of non-choke species. We highlight the 
    importance of including technical interactions in multi-species 
    assessment models and management objectives, how choke species can 
    indicate mismatches between management objectives and system dynamics, 
    and recommend hierarchical multi-species models for multi-species 
    fishery management systems.

date: \today
bibliography: bib/library.bib
natbib: true
journal: Fisheries Research
biblio-style: plainnat
csl: csl/fisheries-research.csl 
layout: review,authoryear
geometry: letterpaper
toc: true
fontsize: 12pt
linenumbers: true
csl-refs: true
params:
  groupFolder: "DERTACS_reruns_sep24"
  baseline: "sim_omni_totCat_200reps"
  history: "fit_parBatfitAAL12"
numbersections: true
appendix: false
output: 
  pdf_document:
    citation_package: natbib
    keep_tex: true
    fig_caption: true
    latex_engine: pdflatex
  bookdown::pdf_document2:
    citation_package: natbib
    keep_tex: true
    fig_caption: true
    latex_engine: pdflatex
    template: ~/Work/write/templates/tex/elsevier2.latex
  bookdown::pdf_book:
    base_format: rticles::elsevier_article
    citation_package: natbib
    keep_tex: true
    fig_caption: true
    latex_engine: pdflatex
  html_document:
    self_contained: true
    df_print: kable
    keep_md: true
  bookdown::html_document2:
    self_contained: true
    df_print: kable
    keep_md: true
  word_document:
    df_print: kable
    reference_docx: /Users/sdnjohnson/Work/write/templates/docx/basic.docx
  bookdown::word_document2:
    df_print: kable
    reference_docx: /Users/sdnjohnson/Work/write/templates/docx/basic.docx
header-includes:
  - \usepackage{lscape}
  - \usepackage{pdflscape}
  - \usepackage{bbold}
  - \newcommand{\blandscape}{\begin{landscape}}
  - \newcommand{\elandscape}{\end{landscape}}
  - \DeclareMathOperator*{\argmax}{arg\,max}
  - \DeclareMathOperator*{\argmin}{arg\,min}
  - \newpageafter{abstract}
  - \geometry{letterpaper,top = 20mm,left = 20mm,right = 20mm}
keywords:
  - Data-limited fisheries management;
  - Multi-species fisheries management;
  - technical interactions;
  - Management Strategy Evaluation;
  - hierarchical Multi-species Stock Assessment;
  - Choke species.
---


```{r setup, echo=FALSE, cache=FALSE, message=FALSE, results='hide', warning=FALSE}
library(knitr)
if (is_latex_output()) {
  knitr_figs_dir <- "knitr-figs-pdf"
  knitr_cache_dir <- "knitr-cache-pdf"
  fig_out_type <- "pdf"
  kable_format <- "latex"
} else {
  knitr_figs_dir <- "knitr-figs-docx"
  knitr_cache_dir <- "knitr-cache-docx"
  fig_out_type <- "png"
  kable_format <- "pandoc"
}
fig_asp <- 0.618
fig_width <- 6
fig_out_width <- "6in"
fig_dpi <- 300
fig_align <- "center"
fig_pos <- "htb"
opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  comment = "#>",
  fig.path = knitr_figs_dir,
  cache.path = knitr_cache_dir,
  fig.asp = fig_asp,
  fig.width = fig_width,
  out.width = fig_out_width,
  echo = FALSE,
  #  autodep = TRUE,
  #  cache = TRUE,
  cache.comments = FALSE,
  dev = fig_out_type,
  dpi = fig_dpi,
  fig.align = fig_align,
  fig.pos = fig_pos
)
options(xtable.comment = FALSE)
options(kableExtra.latex.load_packages = FALSE)
options(knitr.kable.NA = '')

projDir <- here::here("Outputs",params$groupFolder)


source(here::here("tools.R"))
source(here::here("ms3Rplots.R"))
source(here::here("stats.R"))

# Get history path
histFolder <- params$history
histPath <- here::here("history",histFolder)

```

```{r load-libraries, cache=FALSE}
# add other packages here:
library(kableExtra)
library(tidyverse)
library(coda)
library(MASS)
library(chemometrics)
library(mvtnorm)
```



