# Results

```{r loadInfoFiles, echo = FALSE, include = FALSE, warning = FALSE}
# Now read in all the info files
info.df <- readBatchInfo(batchDir = projDir) %>%
      mutate( blobPath = "", 
              perfTabPath = "", 
              lossBlobPath = "" )
# Update paths for each RData file and perf 
# table file
for( simIdx in 1:nrow(info.df))
{
  simLabel <- info.df$simLabel[simIdx]

  info.df$blobPath[simIdx]     <- file.path(projDir, simLabel, paste(simLabel,".RData",sep = "") )
  info.df$perfTabPath[simIdx]  <- file.path(projDir, simLabel, "simPerfStats.csv" )
  info.df$lossBlobPath[simIdx] <- file.path(projDir, simLabel, "loss.RData" )
}


```


## Omniscient Manager Performance


As expected, the omniscient manager was able to achieve the theoretical 
multi-species optimal yield in the presence of technical interactions during
the middle of the projection period (Figure 4, blue closed circle). Median 
biomass, catch, and fishing mortality reach the equilibrium after a transition 
period of about 20 years. During the transitionary period, effort is slowly 
ramped up in each area from the end of the historical period, stabilising 
around area-specific $E_{MSY}$ after about 12 years (Figure 5, blue closed 
circles). As is common, maximising catch over a finite time horizon led to 
a reduction in biomass and an increase in effort towards the end of the 
80 year projection period, where the lower biomasses resulting from 
overfishing the stock relative to the multi-species optimal harvest 
rate/effort are less of a penalty than the catch increases; however, the
omniscient manager avoids a complete crash of the complex thanks to the 
penalty on avoiding the critically overfished state at 40\% of single 
species $B_{MSY,SS}$.

Each area had similar relationships between single-species and multi-species
optimal biomass levels, with one species overfished, one underfished, and one
close to optimally fished, relative to single-species reference points. 
In HSHG and QCS, the overfished stocks were both Rock sole, fished down to
74\% (HSHG) and 81\% of $B_{MSY,SS}$ to increase fishery access to Dover 
and English soles in those areas (Table 1). In WCVI, English sole was 
slightly overfished relative to single-species at 91\% of $B_{MSY,SS}$, but
this would be of little concern in a real fishery if the absolute size were
not so small. Despite the tendency of the omniscient manager toward 
overfishing at least one species in each area, very few optimal solutions 
risked severe overfishing below 40\% of $B_{MSY}$ (Table 3), indicating that 
lost yield from more intense overfishing relative to single-species
optimal levels is not compensated by increased harvest from other species,
which are sometimes larger populations with higher TACs. The probability 
of being critically overfished in the period 2028 - 2037 was 1\% for 
English and Rock sole stocks, and 0\% for all Dover sole stocks.

Although DER stocks begin the simulations in an overall healthy state, 
the omniscient manager reduced fishing effort to 0 in all areas early in 
the projection period in some replicates (Figure 5, 2016-2020). In these 
cases, anticipatory feedback control by the omniscient manager reduced 
fishing effort to avoid low spawning stock biomasses, thus ensuring higher 
production in later time steps where recruitments were lower than average
for sustained periods.

## Assessment model performance

### Rankings by catch loss

Due to low convergence rates for HSHG Rock sole in the Rich scenario,
and QCS and WCVI Rock sole under the Mod scenario (Figure S.1), all 
Rock sole results are excluded from catch loss rankings.

Hierarchical Multi-stock assessment models ranked highest under the Poor 
and Mod data quality scenarios (Table 4). Under the Poor data 
quality scenario, the Hierarchical model had the lowest cumulative absolute 
catch loss in over 40\% of replicate/stock/species combinations (Figure 6), 
ranking highest by average and modal rank in the aggregate. When split
across individual species/areas, the modal rank for the hierarchical AM
remained at 1, but there was more variability in the ranking distributions
in the HSHG area, leading to a drop in average rank  (Figure S.1). As data 
quantity increased for the Mod scenario, the modal rank and average rank 
of the hierarchical model remained the highest out of all AMs in the 
aggregate, ranking 1st in 60% of cases (Figure 6), while the variability 
in rankings in the HSHG area was reduced (Figure S.1), pushing the average 
rank higher than under the Poor scenario. It was only under the Rich scenario 
that the Hierarchical model rank fell, to fourth place by average rank, 
and equal last with the Single-stock AM by modal rank, driven by 
consistently poor performance in the QCS and WCVI areas (Figure S.1).

Under the Rich data quality scenario, the the data pooling methods ranked 
highest in both modal and average ranks (Table 4, Rich). Species pooling 
and spatial pooling performed similarly under the Rich scenario, with
only a small difference between average ranks, and the similar frequencies
between modal and second highest observed ranks (Figure 6, Rich scenario),
a pattern reflected in individual stock rank distributions (Figure S.1).
The Total Pooling AM's rank of 3rd place reflected its rank distribution, 
where the modal rank of 3 was observed in over 50\% of cases in the aggregate 
(Figure 6), and was also the modal rank for all individual stock 
distributions (Figure S.1). As data were removed for the Mod data quality 
scenario, the average and modal ranks of all pooled methods dropped, but
the relative ordering remained the same. The Single-stock method had the 
worst rank under all data-quality scenarios, with a consistent modal rank 
of 5th across all scenarios (Figure 6), with most consistently inferior 
performance observed under the Mod data quality scenario, where the 
average rank was 4.54 (Table 4).

Choke effects both increased and reduced catch loss, depending
on the assessment errors. On the one hand, there were several cases
under where AM underestimates of biomass and/or productivity produced TACs 
that produced a realised harvest rate much lower than the target associated 
with maximum multi-species yield. This behaviour was most prominent under 
single-stock AMs for the Poor and Mod scenario, where the fished 
initialisation led the AMs to estimate a larger and less productive stock
in equilibrium, estimating a steep early decline in biomass followed by 
apparent equilibration to a low biomass state where catch balances production 
[Figure 7], producing very low TACs despite the positive error in unfished
biomass. Low TACs of more catchable species constrained the TACs of 
the remaining species, increasing catch loss across the whole complex 
(Figure 8). On the other hand, when TACs pushed harvest rates very close 
to the target level, choke effects could reduce catch loss by constraining 
TACs that were too high compared to the target, protecting against overfishing
relative to the multi-species harvest rate. These "protective" choke
effects were observed under the pooling AMs and the hierarchical AM,
and occured even when there were large assessment errors. For example, under 
the hierarchical AM in the Mod scenario, AMs perceived a larger and less 
productive stock, similar to the single-stock AM, but shrinkage
priors on catchability and productivity parameters were able to reduce the
magnitude of the error in the initial biomass under the fished 
initialisation (Figure 9). Biomass estimates were then positively biased with
respect to the operating model biomass, which was offset by the lower
productivity estimates, producing more appropriately scaled TACs for
all stocks, with choke effects occasionally protecting against overfishing.
More optimal TACs then reduced catch loss overall, with median
catch loss close to zero for the 2028 - 2037 period (Figure 10).

### Biomass risk

There was little risk of overfishing under any data scenario and AM
combination (Table 4). No AM pushed stocks into a critically overfished 
state where $B_{s,p,t} < 0.4 B_{MSY,SS,s,p}$ under the Rich and Mod data 
scenarios, while under the Poor scenario a small probability of being  
critically overfished was observed under the Species Pooling (1\%) and 
Spatial Pooling (6\%) AMs. There were positive probabilities of being
overfished ($B_{s,p,t} < 0.8 B_{MSY,SS,s,p}$) under all scenarios,
with the highest observed under the Spatial Pooling AM and Poor scenario.
The Single-stock AM never overfished any stock under any data scenario,
as it always underestimated at least one species' biomass in each
area, producing a choke constraint and high catch loss as discussed
above.

### Catch-Biomass trade-offs

Distributions of catch and biomass relative to $MSY_{MS}$ and
$B_{MSY,MS}$, respectively, were produced for the time
period $2028 \leq t \leq 2037$ for each assessment model and Scenario
combination. The medians of those relative catch and biomass 
distributions were visually compared to each other and to the 
central 95\% of the omniscient manager's trajectories over the 
same time period (Figure 11) in order to understand the biomass and 
catch trade-offs between different model choices.

The Hierarchical Multi-stock assessment model median catch between 2028 
and 2037 came closest (i.e., smaller Euclidean distance) to the omniscient 
manager median catch under the Poor data quality scenario outside the HSHG 
area (Figure 11, compare points to the horizontal segment in black 
crosshair). Within HSHG, while the Hierarchical model tended to take a
little more catch than the omniscient manager under the Poor scenario, 
a large biomass surplus relative to the omniscient manager was present, 
indicating that realised harvest rates from TACs set by the hierarchical
AM are smaller than those set by the omniscient manager.

Although the range of biomass-catch trade-offs are quite broad for each 
stock, the majority of Scenario/AM combinations lie inside the central 
95\% distributions of the omniscient manager (Figure 11, black crosshairs). 
Notable exceptions to this were the Single-stock models for all 
species/areas under the Rich scenario and in HSHG under the Poor scenario
for Dover and English, the Hierarchical models in QCS and WCVI under the 
Rich scenario, and the Total Pooling method for WCVI Rock sole under the 
Rich data quality scenario. As described above, the Single-stock methods 
tended to under-estimate biomass and productivity under the Poor scenario, 
so the tendency of the Single-stock median biomass-catch to be towards the 
lower right corner of the range is expected. For the Single-stock and 
Hierarchical methods under the Rich scenario, the reason is a combination 
of large negative assessment errors in some or all years for choke speies, 
and the 20\% limit on increases in catch, producing a low-catch/high-biomass
paradigm. Finally, the Total Pooling outlier in WCVI Rock is caused by 
a persistent small negative assessment error, and an underallocation of the 
pooled TAC to WCVI Rock thanks to the differing Synoptic survey 
catchabilities. The Total Pooling and Hierarchical methods for HSHG
English and Rock soles were also outside the central 95\% of the omnisceint
manager, but only marginally so. 

Catch-biomass trade-offs were approximately collinear under both
Rich and Poor data quality scenarios for all stocks. All stock
spawning biomasses are well above both the single-species and multi-species 
optimal levels at the beginning of the projection period (e.g., Table 1,
Stock Status), meaning that the catch limits set by all methods 
were depleting a standing stock and benefited from its surplus 
production. Under these conditions, an increase in catch almost linearly 
caused a decrease in biomass as the compensatory effect of density dependence
was minimal.


## Sensitivity of results to prior standard deviations

We summarised average model sensitivities by fitting linear regressions to 
the distributions of median cumulative absolute catch loss. To remove the 
effect of absolute catch scales on the regressions, median loss 
distributions were standardised across assessment models, stratified by 
species, stock-area, and data scenario. Regressions with positive slopes 
have increasing catch loss with increasing prior uncertainty, and negative 
or zero slopes indicate a decrease or no change in catch loss with 
increasing prior uncertainty.

The Hierarchical Multi-stock model was least sensitive to increasing 
$B_{MSY}$ prior CVs in both Rich and Poor data quality scenarios.
Cumulative catch loss actually decreased on average with increasing
$B_{MSY}$ prior CVs when catch limits were set by the Hierarchical
model under the Poor data quality scenario, decreasing by about 0.3 
standard deviations over the range of CVs tested (Figure 9, left column, 
Poor). While cumulative catch loss from Hierarchical models increased on 
average with increasing $B_{MSY}$ prior CVs under the Rich data quality 
scenario, the slope of the regression line was the lowest among methods 
(equal with the Species Pooling and Total Pooling methods), implying 
the least sensitivity to prior specifications. 

Cumulative catch loss under the Hierarchical model was also 
insensitive to the complex mean $U_{MSY}$ hyperprior standard deviation, 
with zero slope regression lines under both Rich and Poor data quality 
scenarios over the range of tested log-normal prior SDs (Figure 9, middle
column). The lack of sensitivity of the Hierarchical model to the 
$U_{MSY}$ hyperprior was partially because target harvest rates were based 
on theoretically optimal levels, and not estimated from the assessment model; 
however, this implies that the biomass estimates were also insensitive to the 
hyperprior standard deviation, which may be because the effect of the 
hyperprior was soaked up by the two levels of shrinkage priors between 
the complex mean and stock-specific estimates of $U_{MSY}$.

Hierarchical Multi-stock assessment models were more able to suitably 
scale catch limits to operating model biomass under relaxed catchability 
and $U_{MSY}$ hierarchical shrinkage priors. As $\sigma_{U_{MSY}}$ 
and $\tau_q$ increased from 0.1 to 0.5, average catch loss dropped by about 
0.4 standard deviations under the Rich data quality scenario, and 0.8 standard 
deviations for the Poor data quality scenario (Figure 9, third column). 
Improvements stemmed from a change in assessment model errors in the HSHG area, 
in particular (Figures C.1, C.2, Appendix C). The change in assessment 
performance switched the choke species from English to Rock sole in HSHG, 
and while most assessments were biased and had strong retrospective 
patterns, the combination of higher catch limits and favourable 
technical interactions produced catches that were more closely aligned 
with the omniscient manager's and the multi-species maximum yield.

As expected, cumulative catch loss increased with decreasing prior
precision under all other assessment methods. The Single-stock model 
was most sensitive to $B_{MSY}$ CVs under both Rich and Poor data quality 
scenarios, and to $U_{MSY}$ log-normal SDs under the Poor data quality 
scenario, indicating that, as expected, the single-stock model was more 
uncertain under less informative priors. The Total Pooling and Spatial 
Pooling methods were most sensitive to the $U_{MSY}$ prior standard deviation, 
which may indicate a that the aggregate prior mean values we calculated for 
those assessment models were not well supported by the aggregated data.

