\clearpage
# Figures



```{r figCaptions, echo = FALSE, include = FALSE, warning = FALSE }
DERcplxMapCap <- "Mininum trawlable survey biomass $B_{trawl}$ estimates for DER 
complex species on the BC coast, aggregated to a 10km square grid.
Estimates are produced by scaling average trawl survey ($kg/m^2$) 
density values in each grid cell by the cell's area in $m^2$. 
Locations that do not show a coloured grid cell do not have any 
survey blocks from which to calculate relative biomass. Survey density 
for each grid cell is calculated from data for the Hecate Strait 
Assemblage Survey and the BC Groundfish Trawl Synoptic Survey, stored 
in the GFBio data base maintained at the Pacific Biological Station 
of Fisheries and Oceans, Canada. Thick black lines delineate the major 
statistical areas 3CD and 5ABCDE used for groundfish management BC, while
the dashed grey lines makr out latitude and longitude, indicating the
rotation of the coordinates to save space. The full colour figure 
is available in the online version of the article."


dataSummFigCap <- "A summary of DER complex data available for fitting the 
assessment model. Panels show species from left to right, and rows show
stock areas from north to south. Each panel is split into four cells, with
the top three showing a filled circle when a biomass index, age-composition,
length-composition, or length-conditional age-composition exists for 
each fleet (colours) for the indicated year. The bottom cell shows commercial 
catch (relative to the maximum catch) in grey bars."


SBsptCaption <- "Spawning biomass (red solid line), unfished biomass (red 
horizontal dashed line), catch (grey bars), and scaled biomass indices 
(coloured points), for all stocks and species. Indices are scaled by the 
fleet catchability and the ratio of spawning biomass to vulnerable biomass, 
i.e. $ I^{scaled}_{s,p,f,t} = \\frac{I_{s,p,f,t} SSB_{s,p,t}}{q_{s,p,f,t} B_{s,p,f,t}}$."


econDashCap <- "Maximum likelihood estimates of DER complex demand curves 
from 2016 (top-left), time-series of annual reference and ex-vessel unit 
prices (top-right), and random-walk deviations over time (bottom-left). 
For the 2016 demand curves, the horizontal line segments show the 
reference price of each species at the coast-wide 
$MSY_s = \\sum_{p} MSY_{SS,s,p}$. Price time series show reference price 
MLEs (open circles, joined by a time-series line within a species) and 
observed ex-vessel prices (closed circles) joined by a vertical line 
segment, with species jittered to reduce overlap. Finally, the random-walk 
deviations show each species' time series of random walk jump MLEs (jittered), 
with mean deviations shown in the legend."

eqbmYieldCurveCap <- "Steady state equilibrium catch yield by species and 
for the DER complex as a function of fishing effort for each stock area. 
Each panel shows the three individual DER complex species yield curves in 
different colours, and the complex yield curve found by summing the three 
species curves as a solid black line. Effort $E_{MSY,MS,p}$ maximising 
the multi-species yield in each area is marked by the vertical dashed line 
segment, and the multi-species yield $MSY_{MS,p}$ and species yields at 
that effort are shown by horizontal dashed line segments meeting the
$E_{MSY,MS,p}$ segment where it intersects each curve."

econYieldCurveCap <- "Steady state net resource rents, species and 
complex revenue, and variable costs of fishing as functions of fishing effort for  
the DER complex in each area (first three panels), as well as coast-wide 
(bottom panel). Each panel shows the three individual DER complex species 
revenue curves in different colours, the multi-species revenue curve found 
by summing the three species curves as a solid black line, fuel costs as 
a solid red line, and net resource rent as a dashed black line."

effortTulipsCap <- "Simulation envelopes of commercial trawl effort
over the projection period for the stochastic optimisation under the
catch maximising (black/grey) and rent maximising (red/pink) objective
functions. Horizontal dashed lines show steady-state $E_{MSY}$ (long/short
dashed) and $E_{MEY}$ (long dashed), while vertical lines show the 
beginning of the projection period (thin short dashed in 2017) and the
beginning and end of the time period over which dynamic optima are 
calculated (thicker short dashed lines in 2041 and 2060)."

dynOptUCap <- "Medians (points) and central 95\\% (grey bars) of simulated 
harvest rates under the stochastic optimisation between 2041 and 2060 when 
maximising complex catch (circles) and producer surplus (triangles). 
The horizontal axis is scaled to single-species equilibrium $U_{MSY,SS}$, 
indicated by a vertical dashed black line, with steady state optima shown as 
open red points for comparison."

bioDistCap <- "Distributions of 2048 biomass relative to single-species
$B_{MSY}$ for all DER complex stocks under the closed loop simulations. 
Line segments show the central 90\\% of the simulated biomass distribution 
and points show median biomas. Line segments differ for the perfect 
(solid) and imperfect (dashed) information scenarios, while points differ 
between steady state (open) and dynamic (closed) optimal harvest rates 
targeting maximum catch (circle) or net-present value of resource rents 
(square). Horizontal dashed reference lines show $B_{MSY}$ (grey) and 
$0.8 B_{MSY}$ (orange) to indicate conservation risk."

imperfectInfoSimEnvCap <- "An example simulation biomass envelope from the 
imperfect information scenario for each DER complex species (columns) and 
area (rows) when TACs were set using the steady-state multi-species catch 
maximimising harvest rate $U_{MSY}$. Envelopes show median biomass (heavy 
black lines) and the central 90\\% of the simulated biomass distribution 
(grey regions), with random simulation replicates shown as thin black 
traces. The historical period shows fixed catch (grey bars), with catch in 
the projection period shown as the central 90\\% (thin black line segment) 
and median (grey bars) over all simulation replicates."

rentTulipsCap <- "Simulated central 90\\% (shaded regions) and median annual 
(thick line) resource rents extracted by the trawl fishery over the 
projection period under the imperfect information scenario with TACs set 
using dynamic optima $U_{MSY}^*$ (grey region, solid black line) and 
$U_{MEY}^*$ (pink region, dashed red line). Horizontal dashed lines 
show steady-state $MEY$ for each stock area, while the vertical dashed 
line shows the beginning of the projection period in 2017."
```

```{r fig1-DERcomplexSurveyBio, echo = FALSE, warning = FALSE, fig.cap = DERcplxMapCap }
figPath <- file.path("./figure/fig1-DERcomplexSurveyBio.pdf")
knitr::include_graphics(figPath)
```

\blandscape
```{r fig2-dataSummmary, echo = FALSE, warning = FALSE, fig.cap = dataSummFigCap, fig.width = 7, out.width = "9in" }
figPath <- file.path("./figure/fig2-dataSummmary.pdf")
if(params$redoPlots)
{
  graphics.off()
  pdf(file = figPath, width = 7/fig_asp, height = 7 )
  plotDataSummary(  simObj, 
                    fleetLabs = c(  "Historical",
                                    "Modern",
                                    "HS Ass.",
                                    "Synoptic"),
                    dataCells = c(  "Indices",
                                    "Ages",
                                    "Lengths",
                                    "Catch") )
  dev.off()
}
knitr::include_graphics(figPath)
```



```{r fig3-SpawnBioPlots, echo = FALSE, warning = FALSE, fig.cap = SBsptCaption, fig.width = 7, out.width = "9in" }
figPath <- file.path("./figure/fig3-SpawnBioPlots.pdf")
if(params$redoPlots)
{
  graphics.off()
  pdf(file = figPath, width = 7/fig_asp, height = 7 )
  plotSBspt( reports, pub = TRUE)
  dev.off()
}
knitr::include_graphics(figPath)
```

\elandscape



```{r fig4-inverseDemandCurves, echo = FALSE, warning = FALSE, fig.cap = econDashCap, fig.width = 6, out.width = "7in" }
figPath <- file.path("./figure/fig4-inverseDemandCurves.pdf")
if(params$redoPlots)
{
  graphics.off()
  pdf(file = figPath, width = 7, height = 7 )
  plotEconModelDash( obj = blob, priceModel = priceFlexModel )
  dev.off()
}
knitr::include_graphics(figPath)
```


```{r fig5-DERcomplexCatchYieldCurves, echo = FALSE, warning = FALSE, fig.cap = econYieldCurveCap }
figPath <- file.path("./figure/fig5-DERcomplexYieldCurves.pdf")
if(params$redoPlots | !file.exists(figPath))
{
  graphics.off()
  pdf(file = figPath, width = 8.5, height = 11 )
  plotEffYieldCurves( obj = simObj, 
                      maxE = 80,
                      pIdx = 1:3,
                      sIdx = 1:3,
                      plotCplx = TRUE )
  dev.off()
}

knitr::include_graphics(figPath)
```


```{r fig6-DERcomplexEconYieldCurves, echo = FALSE, warning = FALSE, fig.cap = econYieldCurveCap }
figPath <- file.path("./figure/fig6-DERcomplexEconYieldCurves.pdf")
if(params$redoPlots | !file.exists(figPath))
{
  graphics.off()
  pdf(file = figPath, width = 8.5, height = 11 )
  plotCWeconYield(  obj = simObj, 
                    maxE = 80,
                    plotCplx = TRUE )
  dev.off()
}
knitr::include_graphics(figPath)
```


```{r fig7-effortTulips, echo = FALSE, warning = FALSE, fig.cap = effortTulipsCap }
figPath <- file.path("./figure/fig7-effortTulips.pdf")
if(params$redoPlots | !file.exists(figPath))
{
  graphics.off()
  pdf(file = figPath, width = 8.5, height = 11)
  compareTulipEffort( groupFolder = "omni_econYield_splineE_long_Jan4",
                      scenarios = "noCorr",
                      rpSim = params$sim,
                      fleets = 1:2,
                      combineEff = TRUE,
                      proj = TRUE,
                      highlightPer = c(2041,2060) )
  dev.off()
}
knitr::include_graphics(figPath)

```


```{r fig8-dynUmsy, echo = FALSE, warning = FALSE, fig.cap = dynOptUCap }
figPath <- file.path("./figure/fig8-dynUmsy.pdf")
if(params$redoPlots | !file.exists(figPath))
{
  graphics.off()
  pdf(file = figPath, width = 8.5, height = 11)
  plotDynUmsy_sp()
  dev.off()
}
knitr::include_graphics(figPath)
```


```{r fig9-bioDist, echo = FALSE, warning = FALSE, fig.cap = bioDistCap }
figPath <- file.path("./figure/fig9-bioDist.pdf")
if(params$redoPlots | !file.exists(figPath))
{
  graphics.off()
  pdf(file = figPath, width = 8.5, height = 11)
  plotBioDist()
  dev.off()
}
knitr::include_graphics(figPath)
```

\blandscape

```{r fig10-simEnvelope, echo = FALSE, warning = FALSE, fig.cap = imperfectInfoSimEnvCap }
figPath <- file.path("./figure/fig10-simEnvelope.pdf")
if(params$redoPlots | !file.exists(figPath))
{
  .loadSim(1,groupFolder=  "simAssErrs_noCorr")
  graphics.off()
  pdf(file = figPath, width = 7/fig_asp, height = 7)
  plotTulipBt(dep = TRUE, Ct = TRUE)
  dev.off()
}
knitr::include_graphics(figPath)
```

\elandscape

```{r fig11-rentTulips, echo = FALSE, warning = FALSE, fig.cap = rentTulipsCap }
figPath <- file.path("./figure/fig11-rentTulips.pdf")
if(params$redoPlots | !file.exists(figPath))
{
  graphics.off()
  pdf(file = figPath, width = 8.5, height = 11)
  compareTulipRent( groupFolder = "simAssErrs_noCorr",
                    scenarios = "noCorr",
                    mps = c("simAssError_noCorr.MSY","simAssError_noCorr.MEY"),
                    rpSim = "sim_baseRun",
                    fleets = 2,
                    proj = TRUE )
  dev.off()
}
knitr::include_graphics(figPath)

```